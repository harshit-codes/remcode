/**
 * This script removes all -rem.md files from the project.
 * Run this to clean up documentation files generated by the previous
 * co-located documentation approach before switching to the new 
 * rem-docs directory structure.
 */
const fs = require('fs');
const path = require('path');

const PROJECT_ROOT = path.resolve(__dirname, '..');

function cleanupRemFiles(dirPath) {
  const entries = fs.readdirSync(dirPath, { withFileTypes: true });
  let count = 0;
  
  // Directories to skip
  const skippedDirs = ['node_modules', '.git', 'dist', 'coverage', '~deps', 'rem-docs'];
  
  for (const entry of entries) {
    const fullPath = path.join(dirPath, entry.name);
    
    // Skip certain directories
    if (skippedDirs.some(d => fullPath.includes(d))) {
      continue;
    }
    
    if (entry.isDirectory()) {
      count += cleanupRemFiles(fullPath);
    } else if (entry.isFile() && entry.name.endsWith('-rem.md')) {
      fs.unlinkSync(fullPath);
      console.log(`Removed: ${path.relative(PROJECT_ROOT, fullPath)}`);
      count++;
    }
  }
  
  return count;
}

console.log('Starting cleanup of all -rem.md files...');
const count = cleanupRemFiles(PROJECT_ROOT);
console.log(`Removed ${count} files.`);
console.log('Documentation is now generated in the rem-docs directory.');
